import sys
from src.opcodes import opcodes_list


def checkThenOpen(argv):
    '''
    Ensures that only one file with an extension of
    .asm or .s has been passed to the program
    
    Parameters
    -------------
    argv: list
        the command line arguments passed to the program

    Returns
    ------------
    readFile: file
        a file object in "r" mode of the assembly
        file to be processed
    '''

    if(len(sys.argv) > 2):
        print("Too many arguments")
        sys.exit(1)
    
    try:
        inputFile = sys.argv[1]
    except IndexError:
        print("Must provide one assembly file to assemble")
        sys.exit(1)

    if not inputFile.lower().endswith(('.s', '.asm')): 
        print("Must be a .s or .asm file")
        sys.exit(1)

    readFile = open(inputFile, "r")

    return readFile


def get_opcode_hex(opcode, addressing):
    '''
    gets the hexadecimal code 
    for the inputted opcode
    
    Parameters
    -------------
    opcode: str
        the opcode to search for

    addressing: str
        the addressing type to index
        into

    Returns
    ------------
    the hexadecimal code of that opcode
    for the addressing specified
    '''
    x = opcodes_list.index(addressing)

    return opcodes_list[x][opcode]


